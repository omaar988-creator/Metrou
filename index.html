<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metrou App</title>
    <style>
        body { background: #131f24; color: white; font-family: sans-serif; text-align: center; margin: 0; }
        .header { padding: 20px; background: #202f36; font-weight: bold; }
        .stats { display: flex; justify-content: space-around; padding: 15px; background: #131f24; border-bottom: 1px solid #333; }
        .track { display: flex; flex-direction: column; align-items: center; gap: 40px; padding: 40px 0; position: relative; }
        .track::before { content: ''; position: absolute; width: 4px; height: 100%; background: #3b4c54; z-index: 0; }
        .node { width: 60px; height: 60px; background: white; border-radius: 50%; border: 4px solid #58cc02; display: flex; align-items: center; justify-content: center; color: black; font-weight: bold; cursor: pointer; z-index: 1; transition: 0.2s; }
        .node:active { transform: scale(0.9); }
        .locked { border-color: #3b4c54; background: #202f36; color: #3b4c54; }
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ù…ÙØªØ´ */
        #inspector { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; }
        .btn { background: #58cc02; color: white; border: none; padding: 12px 30px; border-radius: 20px; font-size: 18px; cursor: pointer; margin-top: 15px; }
    </style>
</head>
<body>

    <div class="header">Metrou: Ø±Ø­Ù„Ø© Ø§Ù„Ù…ØªØ±Ùˆ ğŸš‡</div>
    
    <div class="stats">
        <div style="color: #ffc800;">â­ <span id="pts">0</span></div>
        <div style="color: #ff4b4b;">âš¡ <span id="nrg">5</span></div>
    </div>

    <div class="track">
        <div class="node" onclick="alert('Ø§Ù„Ù…Ø­Ø·Ø© 1: Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø¨Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©')">1</div>
        <div class="node locked" onclick="showInspector('Ø§Ù„Ø£ÙØ¹Ø§Ù„')">ğŸ”’</div>
        <div class="node locked" onclick="showInspector('Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯')">ğŸ”’</div>
    </div>

    <div id="inspector">
        <div style="font-size: 70px;">ğŸ‘®â€â™‚ï¸</div>
        <h2 style="color: #ff4b4b;">ØªÙØªÙŠØ´ Ù…ÙØ§Ø¬Ø¦!</h2>
        <p id="q-text" style="padding: 20px; font-size: 18px;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø³Ø¤Ø§Ù„ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ù† Gemini...</p>
        <button class="btn" onclick="resolve(true)">Ø£Ø¹Ø±Ù Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© âœ…</button>
        <button class="btn" style="background: #3b4c54;" onclick="resolve(false)">Ù„Ø§ Ø£Ø¹Ø±Ù (Ø®ØµÙ… Ø·Ø§Ù‚Ø©)</button>
    </div>

    <script>
        // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ù‡Ùˆ Ø±Ø§Ø¨Ø· Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ÙÙŠ Render
        const API_URL = "https://metrou-db.onrender.com";
        let energy = 5;
        let points = 0;

        function showInspector(topic) {
            if (energy <= 0) return alert("Ù†ÙØ¯Øª Ø·Ø§Ù‚ØªÙƒ!");
            document.getElementById('inspector').style.display = 'flex';
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ø³Ø¤Ø§Ù„ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
            fetch(`${API_URL}/api/ai/explain`, {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({ topic: `Ø³Ø¤Ø§Ù„ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¹Ù† ${topic}` })
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById('q-text').innerText = data.explanation;
            })
            .catch(err => {
                document.getElementById('q-text').innerText = "Ø§Ù„Ù…ÙØªØ´: ØªØ±Ø¬Ù… 'Bonjour' Ù„Ù„Ù…Ø±ÙˆØ±!";
            });
        }

        function resolve(success) {
            if (success) {
                points += 10;
                document.getElementById('pts').innerText = points;
                alert("Ù…Ø±Ø±Øª Ø¨Ø³Ù„Ø§Ù…! ÙƒØ³Ø¨Øª 10 Ù†Ù‚Ø§Ø·.");
            } else {
                energy--;
                document.getElementById('nrg').innerText = energy;
                alert("ØªÙ… Ø®ØµÙ… Ø·Ø§Ù‚Ø© ÙˆØ§Ø­Ø¯Ø©.");
            }
            document.getElementById('inspector').style.display = 'none';
        }
    </script>
</body>
</html>
